# IRC3D - Video player for head pose compare

Video player to compare a face from a low quality CCTV video with a 3D modeled face (generated by IRC3D, available soon). 

This software is part of a research thesis of the Criminal Investigation Institute of the National Gendarmerie (IRCGN) managed by Marie-Charlotte Poilpré (marie-charlotte.poilpre@gendarmerie.interieur.gouv.fr). 
It is based on the head pose detection in deep lerning [Hopenet](https://github.com/natanielruiz/deep-head-pose), by Nataniel Ruiz, Eunji Chong, James M. Rehg from Georgia Institute of Technology.

## Launch the application
To launch the application you have to start the `main.py` in the code folder
```
cd code/
python3 main.py
```

If the configuration file can not be found, you can pass it as a parameter
```
python3 main.py --config [MY_CONFIG_PATH]
```

## Configuration
You can configure the application from the json file `config.json`
* `snapshot` path of the Hopenet trained model to use to calculate the orientation of the face (.pkl)
* `face_model` path of the dlib face detections model (.dat)
* `gpu_id` the identifier of the GPU to use by default (if no gpu is detected, the cpu will be used)
* `cache_string` text at the end of the video name for its json cache file
* `video_formats` table of all videos formats that can be opened with the application (you must have the codecs to read these files)
* `mesh_formats` table of all 3D mesh formats that can be opened with the application 

## Required libraries

### Dependencies
* Python 3.7 or higher
* Numpy 1.7 or higher
* OpenCV 3.0 or higher
* PyTorch 1.0 or higher
* PyQT 5.0 or higher
* DLIB
* Skimage
* Matplotlib
* Pillow
* Pandas 

### Optional GPU dependencies
If you want to use your graphics card (recommended for faster calculation), you have to install
* Cuda
* CuDNN

### Optional Video codec dependencies
To play videos with opencv, you must have some codec installed on your computer, like:
* ffmpeg or ffmpeg-python
* gstreamer-player

### Installing dependencies
Comming soon...

*Nicolas SENECAL*, *Tom SAMAILLE*, *Florian TORRES*, *Guillaume NICOLUSSI CASTELLAN*, *Paul CHAPELON* 

IMAC engineering school